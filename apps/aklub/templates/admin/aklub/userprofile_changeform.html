{% extends "admin/change_form.html" %}
{% load i18n %}
{% block extrahead %}
{% if urlsafe_query %}
<!-- 1 -->
<link title="timeline-styles" rel="stylesheet" href="https://cdn.knightlab.com/libs/timeline3/latest/css/timeline.css">

<!-- 2 -->
<script src="https://cdn.knightlab.com/libs/timeline3/latest/js/timeline.js"></script>

<script>
 var timeline_loaded = false;
 $(function (){
     $("#timeline-embed").hide();
 });
 function show_hide_timeline() {
     if($("#timeline-embed").is(":visible")) {
         $("#timeline-embed").hide();
         $("#timeline-toggler").text("{% trans 'Show timeline' %}");
     } else {
         $("#timeline-embed").show();
         $("#timeline-toggler").text("{% trans 'Hide timeline' %}");

     }
     if(!timeline_loaded) {
         timeline = new TL.Timeline(
             'timeline-embed',
             '{% url 'helpdesk:timeline_ticket_list' urlsafe_query %}'
         );
         timeline_loaded=true;
     }
 }
</script>
{% endif %}
{{block.super}}
{% endblock %}

{% block object-tools-items %}
{% if urlsafe_query %}
<li>
<a href="#" onclick="show_hide_timeline()" id="timeline-toggler">{% trans 'Show timeline' %}</a>
</li>
{% endif %}
{{block.super}}
{% endblock %}

{% block field_sets %}
{% if urlsafe_query %}
<div id="timeline-embed" style="width: 100%; height: 80vh"></div>
{% endif %}
{{block.super}}
{% endblock %}
