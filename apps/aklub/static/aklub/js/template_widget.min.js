/*! HtmlTemplateEditorDialog v0.0.1 by Tomas Zigo <tomas.zigo@slovanet.sk> */
(function(){var a,b,c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},i=function(a,b){return function(){return a.apply(b,arguments)}};b=function(){function a(){}return a.prototype.getIdFormat=function(a){return"#"+a},a.prototype.getClassFormat=function(a){return"."+a},a.prototype.getNameFormat=function(a,b){return a+"[name='"+b+"']"},a}(),$(document).ready(function(){var a,b,c,e;return a=500,c=750,e=3e3,b=!0,new d("edit_template_dialog","edit_template",a,"id_template_name","id_template_type","id_hidden_template","field-template","field-template_textarea","id_template_textarea","template_page","id_template",c,b,e,"edit_template_btn"),new d("edit_template_en_dialog","edit_template_en",a,"id_template_en_name","id_template_en_type","id_hidden_template_en","field-template_en","field-template_en_textarea","id_template_en_textarea","template_en_page","id_template_en",c,b,e,"edit_template_en_btn")}),e=function(b){function c(a,b,c,d,e,f,g,h,i){this._title=a,this._editTemplateModalDialogId=c,this._backdrop=b,this._$templateNameField=d,this._destroyDelay=e,this._$mountElement=f,this._popoverModalDialogEditTemplateLinkElementId=g,this._$editTemplateModalDialogPageContainer=h,this._$hiddenTemplateField=i,this._$templateDivField=f}return h(c,b),c.editTemplateLinkText=gettext("Edit template"),c.prototype.show=function(b){return b.click(function(b){return function(c){var d,e,f,g;return c.preventDefault(),f=b._$templateNameField.find("option:selected"),e=f.text(),g=f.val().split(":"),d=new a(b._editTemplateModalDialogId,b._popoverModalDialogEditTemplateLinkElementId,b._$editTemplateModalDialogPageContainer,b._$hiddenTemplateField,b._$templateDivField),d.mount(e,"openViaPopoverDialog",g),b.unmount()}}(this)),this.delay(this._destroyDelay,function(a){return function(){return a.unmount()}}(this))},c.prototype.mount=function(a,b){var c;return c=this._getOpt(),c.offsetTop=a,c.offsetLeft=b,WebuiPopovers.show(this._$mountElement,c)},c.prototype.unmount=function(){return this._$mountElement.webuiPopover("hide"),this._$mountElement.webuiPopover("destroy")},c.prototype.delay=function(a,b){return setTimeout(b,a)},c.getContent=function(a,b){var c,d;return c=$("<a></a>"),c.attr({id:this.dialogId,href:""}),d={id:a,"data-type":"modal","data-target":b,"data-fullscreen":"true","data-overlayClick":"true"},c.attr(d),c.html("<b>"+this.editTemplateLinkText+"</b>"),c},c.prototype._getOpt=function(){var a,b;return b=function(a){return function(b){return a.show(b)}}(this),a=c.getContent(this._popoverModalDialogEditTemplateLinkElementId,this.getIdFormat(this._editTemplateModalDialogId)),{placement:"top-right",trigger:"manual,",title:this._title,content:a,offsetTop:0,offsetLeft:0,animation:"fade",backdrop:this._backdrop,onShow:b}},c}(b),c=function(b){function c(a,b,c,d,e,f,g,h){this._getBtns=i(this._getBtns,this),this._confirmTemplateName=i(this._confirmTemplateName,this),this._dialogId="get_template_name",this._title=gettext("Template name"),this._showDelay=a,this._confirmBtnId="confirm_btn",this._$templateDivField=b,this._templateNameInputId="template_name",this._errorListCSSClass="errorlist",this._templateNameFieldId=c,this._newEmptyTemplateName=null,this._editTemplateModalDialogId=d,this._popoverModalDialogEditTemplateLinkElementId=e,this._templateName=f,this._$editTemplateModalDialogPageContainer=g,this._$hiddenTemplateField=h}return h(c,b),c.prototype.unmount=function(){return $(this.getIdFormat(this._dialogId)).dialog("destroy")},c.prototype.mount=function(){return this._getContainer().dialog(this._getOpt())},c.prototype._getContainer=function(){var a,b,c,d,e,f;return e=$("<div></div>"),e.attr({id:this._dialogId}),f=$("<form></form>"),f.attr({id:"template_name_form"}),a=$("<div></div>"),d=$("<ul></ul>"),d.attr({class:this._errorListCSSClass}),c=$("<label></label>"),c.attr({for:this._templateNameInputId}),c.text(gettext("Template name")),b=$("<input>"),b.attr({id:this._templateNameInputId,name:this._templateNameInputId}),a.append(c),a.append(b),a.append(d),e.append(f.append(a)),e},c.prototype.getNeEmptyTemplateName=function(){return this._newEmptyTemplateName},c.prototype._triggerConfirmBtn=function(){var a;return a=function(a){return function(b){if(b.keyCode===$.ui.keyCode.ENTER)return $(a.getIdFormat(a._confirmBtnId)).click()}}(this),$(this.getIdFormat(this._dialogId)).keypress(a)},c.prototype._checkRegexp=function(a,b,c){var d;return!!b.test(a.val())||(d=a.closest("form").find(this.getClassFormat(this._errorListCSSClass)),d.append("<li>"+c+"</li>"),!1)},c.prototype._checkTemplateName=function(a,b,c){var d,e,f;return e=[],f=this.getIdFormat(this._templateNameFieldId)+" > option",$(f).each(function(){return e.push($(this).text())}),!(e.indexOf(b)>-1)||(d=a.closest("form").find(this.getClassFormat(this._errorListCSSClass)),d.append("<li>"+c+"</li>"),!1)},c.prototype._validateTemplateName=function(){var a,b,c,d;return d=!0,a=$(this.getIdFormat(this._templateNameInputId)),$(this.getClassFormat(this._errorListCSSClass)).html(""),c=gettext("Template name may consist of a-z, 0-9, underscores, not spaces and must begin with a letter, and be lowercase."),d=d&&this._checkRegexp(a,/^[a-z]([0-9a-z_])+$/,c),c=gettext("Template name exist."),b=$(this.getIdFormat(this._templateNameInputId)),d=d&&this._checkTemplateName(b,a.val(),c)},c.prototype._confirmTemplateName=function(){var b,c;if(this._validateTemplateName())return this._newEmptyTemplateName=$(this.getIdFormat(this._templateNameInputId)).val(),this.unmount(),this._setNewEmptyTemplateName(),c=[this._newEmptyTemplateName],b=new a(this._editTemplateModalDialogId,this._popoverModalDialogEditTemplateLinkElementId,this._$editTemplateModalDialogPageContainer,this._$hiddenTemplateField,this._$templateDivField),b.mount(this._templateName,"openViaSelectBox",c)},c.prototype._setNewEmptyTemplateName=function(){if(null!=this._newEmptyTemplateName)return sessionStorage.setItem("newEmptyTemplateName",this._newEmptyTemplateName)},c.prototype._getBtns=function(){var a,b;return a={},b=function(a){return function(){return a._confirmTemplateName()}}(this),a.ok={text:gettext("Ok"),id:this._confirmBtnId,click:b},a},c.prototype._getOpt=function(){var a,b;return b=function(a){return function(b,c){return a._triggerConfirmBtn()}}(this),a=function(a){return function(b,c){return a.unmount(),a._$templateDivField.html("")}}(this),{modal:!0,title:this._title,show:{effect:"fade",delay:this._showDelay},resizable:!1,open:b,beforeClose:a,buttons:this._getBtns()}},c}(b),a=function(a){function b(a,b,c,d,e){this._closeEditTemplateModalDialog=i(this._closeEditTemplateModalDialog,this),this._dialogId=a,this._sessionStorageKey="dbTemplateName",this._popoverEditTemplateLinkElementId=b,this._closeBtnClass="mdl-close",this._$editTemplateModalDialogPageContainer=c,this._$hiddenTemplateField=d,this._$templateDivField=e,this._popoverDialog=null}return h(b,a),b.prototype.mount=function(a,b,c){var d,f;if(sessionStorage.removeItem(this._sessionStorageKey),this._popoverDialog||(this._popoverDialog=e.getContent(this._popoverEditTemplateLinkElementId,this.getIdFormat(this._dialogId)),$("body").append(this._popoverDialog)),this.init(this.getIdFormat(this._popoverEditTemplateLinkElementId)),c.length>1?(f=this._setPageContainerArgs(a,"aklub:get_email_template_from_db"),sessionStorage.setItem(this.sessionStorageKey,f)):f=this._setPageContainerArgs(a,"aklub:get_email_template"),this.show(this.getIdFormat(this._dialogId)),d=$(this.getIdFormat(this._dialogId)+" "+this.getClassFormat(this._closeBtnClass)),d.off("click",this._closeEditTemplateModalDialog),d.on("click",this._closeEditTemplateModalDialog),"openViaSelectBox"===b)return $(this.getIdFormat(this._popoverEditTemplateLinkElementId)).remove()},b.prototype._closeEditTemplateModalDialog=function(a){var b;return b=this._getIframeTemplateContent(),new f(b,$(b).find("article"),this._$templateDivField,this._$hiddenTemplateField)},b.prototype._getIframeTemplateContent=function(){var a;return a=document.querySelector(this.getIdFormat(this._$editTemplateModalDialogPageContainer.attr("id"))),null!=a?a.contentDocument:void 0},b.prototype._setPageContainerArgs=function(a,b){var c,d;return d=window.reverse(b,{template_name:a}),c={data:d,width:$(window).width(),height:$(window).height()},this._$editTemplateModalDialogPageContainer.attr(c),d},b.prototype.init=function(a){return $(a).mdl()},b.prototype.show=function(a){return mdl_open(a)},b}(b),d=function(b){function d(a,b,c,d,e,f,g,h,j,k,l,m,n,o,p){this._confirmTemplateEdit=i(this._confirmTemplateEdit,this),this._loadTemplateContent=i(this._loadTemplateContent,this),this._showEditTemplateModalDialog=i(this._showEditTemplateModalDialog,this),this._editTemplateBtnClickEvt=i(this._editTemplateBtnClickEvt,this),this._mouseMoveOverTemplateEvt=i(this._mouseMoveOverTemplateEvt,this),this._replaceTemplateFieldContent=i(this._replaceTemplateFieldContent,this),this._templateDivFieldId=l,this._hiddenTemplateFieldId=f,this._templateNameFieldId=d,this._getTemplateNameDialogShowDelay=c,this._editTemplateModalDialogId=a,this._popoverModalDialogEditTemplateLinkElementId=b,this._templateDivFormFieldContainerCSSClass=g,this._templateTextareaFieldId=j,this._editTemplateModalDialogPageContainerId=k,this._$templateDivFieldContainer=null,this._$templateTextareaFieldContainer=null,this._templateTextareaFieldValue="",this._showPopoverModalDialogDelay=m,this._popoverModalDialogBackDrop=n,this._popoverModalDialogDestroyDelay=o,this._templateTextAreaFormFieldContainerCSSClass=h,this._templateTypeFieldId=e,this._newEmptyTemplateName=null,this._getTemplateNameDialog=null,this._popoverDialogOpts=null,this._editTemplateBtnName=p,this._editTemplateModalDialog=null,this._cacheDom(),this._bindEvents(),this._templateFormFieldWidgetInit()}return h(d,b),d.prototype._cacheDom=function(){return this._$templateDivField=$(this.getIdFormat(this._templateDivFieldId)),this._$hiddenTemplateField=$(this.getIdFormat(this._hiddenTemplateFieldId)),this._$templateNameField=$(this.getIdFormat(this._templateNameFieldId)),this._$templateTypeField=$(this.getIdFormat(this._templateTypeFieldId)),this._$templateDivFormFieldContainer=$(this.getClassFormat(this._templateDivFormFieldContainerCSSClass)),this._$templateTextAreaFormFieldContainer=$(this.getClassFormat(this._templateTextAreaFormFieldContainerCSSClass)),this._$templateTextareaField=$(this.getIdFormat(this._templateTextareaFieldId)),this._$editTemplateModalDialogPageContainer=$(this.getIdFormat(this._editTemplateModalDialogPageContainerId)),this._$editTemplateBtn=$(this.getNameFormat("input",this._editTemplateBtnName))},d.prototype._bindEvents=function(){return this._$templateNameField.bind("change",this._showEditTemplateModalDialog),this._$templateTypeField.bind("change",this._replaceTemplateFieldContent),this._$editTemplateModalDialogPageContainer.bind("load",this._loadTemplateContent),this._$editTemplateBtn.bind("click",this._editTemplateBtnClickEvt)},d.prototype._templateFormFieldWidgetInit=function(){var a;return this._$templateTextAreaFormFieldContainer.addClass("hidden"),"new"===this._$templateTypeField.val()?(this._exchangeFormFieldContainerContent(),a=this._$templateDivField.html(),this._$templateTextareaField.html(a),this._templateTextareaFieldValue=a,this._$templateDivField.html("")):"existed"===this._$templateTypeField.val()&&this._$hiddenTemplateField.val(this._$templateDivField.html()),this._initEditTemplateModalDialog(),this._enableDisableEditBtn(!0)},d.prototype._enableDisableEditBtn=function(a,b){var c;return null==b&&(b=!0),b?(c=this._$templateNameField.find("option:selected").val(),0===c.length?this._$editTemplateBtn.prop("disabled",a):void 0):this._$editTemplateBtn.prop("disabled",a)},d.prototype._getTemplateFieldContainer=function(){this._$templateDivFieldContainer=this._$templateDivFormFieldContainer,this._$templateTextareaFieldContainer=this._$templateTextAreaFormFieldContainer},d.prototype._checkTemplateFieldWidget=function(){var a;return this._getTemplateFieldContainer(),a=this._$templateDivFieldContainer.find("textarea"),a.length?"textarea":"div"},d.prototype._replaceTemplateFieldContent=function(a){var b;b=$(a.target).val(),"new"===b?"textarea"!==this._checkTemplateFieldWidget()&&this._exchangeFormFieldContainerContent():"existed"===b&&"div"!==this._checkTemplateFieldWidget()&&this._exchangeFormFieldContainerContentBack()},d.prototype._exchangeFormFieldContainerContentBack=function(){var a;return this._disableFormFieldWysiwygEditor(),this._$templateNameField.attr("disabled",!1),this._exchangeContent(),a={id:this._templateTextareaFieldId,name:this._templateTextareaFieldId.slice(3)},this._$templateDivField.attr(a),a={id:this._templateDivFieldId,name:this._templateDivFieldId.slice(3)},this._$templateTextareaField.attr(a),this._$editTemplateBtn.off("click",this._editTemplateBtnClickEvt),this._$editTemplateBtn.on("click",this._editTemplateBtnClickEvt)},d.prototype.delay=function(a,b){return setTimeout(b,a)},d.prototype._mouseMoveOverTemplateEvt=function(a){var b,c,d,e,f;return b=$(a.currentTarget).offset(),e=a.pageX-b.left,f=a.pageY-b.top,d=f,c=e,this.delay(this._showPopoverModalDialogDelay,function(a){return function(){return a._initPopoverModalDialog(d,c)}}(this))},d.prototype._initPopoverModalDialog=function(a,b){return this._popoverDialogOpts.mount(a,b)},d.prototype._bindPopoverDialogMouseMoveEvt=function(){return this._popoverDialogOpts=new e(gettext("Edit template"),this._popoverModalDialogBackDrop,this._editTemplateModalDialogId,this._$templateNameField,this._popoverModalDialogDestroyDelay,this._$templateDivField,this._popoverModalDialogEditTemplateLinkElementId,this._$editTemplateModalDialogPageContainer,this._$hiddenTemplateField),this._$templateDivField.mousemove(this._mouseMoveOverTemplateEvt)},d.prototype._initEditTemplateModalDialog=function(){return this._editTemplateModalDialog=new a(this._editTemplateModalDialogId,this._popoverModalDialogEditTemplateLinkElementId,this._$editTemplateModalDialogPageContainer,this._$hiddenTemplateField,this._$templateDivField)},d.prototype._editTemplateBtnClickEvt=function(a){var b,c,d;return a.preventDefault(),c=this._$templateNameField.find("option:selected"),b=c.text(),d=c.val().split(":"),this._editTemplateModalDialog.mount(b,"openViaBtn",d)},d.prototype._exchangeFormFieldContainerContent=function(){var a;return this._$templateTextareaField.html(this._templateTextareaFieldValue),this._$templateNameField.attr("disabled",!0),this._exchangeContent(),a={id:this._templateTextareaFieldId,name:this._templateTextareaFieldId.slice(3)},this._$templateDivField.attr(a),this._$templateDivFieldContainer.find("label").attr("for",this._templateDivFieldId),this._$templateDivFieldContainer.find("label").text(this._$templateTextareaFieldContainer.find("label").text()),a={id:this._templateDivFieldId,name:this._templateDivFieldId.slice(3)},this._$templateTextareaField.attr(a),this._enableFormFieldWysiwygEditor(),this._$templateTextAreaFormFieldContainer.addClass("hidden"),this._$hiddenTemplateField.val("")},d.prototype._enableFormFieldWysiwygEditor=function(){return django_wysiwyg.enable(this._templateDivFieldId.slice(3))},d.prototype._disableFormFieldWysiwygEditor=function(){return django_wysiwyg.disable(this._templateDivFieldId.slice(3))},d.prototype._exchangeContent=function(){var a,b;this._getTemplateFieldContainer(),a=this._$templateDivFieldContainer.children(),b=this._$templateTextareaFieldContainer.children(),this._$templateDivFieldContainer.html(b),this._$templateTextareaFieldContainer.html(a)},d.prototype._showEditTemplateModalDialog=function(b){var d,e,f,g;if(sessionStorage.removeItem("newEmptyTemplateName"),e=""+this.getIdFormat(b.target.id),f=$(e+" option:selected").text(),$(""+e).val().length>0)return"new_empty_template"===f?(this._getTemplateNameDialog=new c(this._getTemplateNameDialogShowDelay,this._$templateDivField,this._templateNameFieldId,this._editTemplateModalDialogId,this._popoverModalDialogEditTemplateLinkElementId,f,this._$editTemplateModalDialogPageContainer,this._$hiddenTemplateField),this._getTemplateNameDialog.mount()):(this._enableDisableEditBtn(!1,!1),g=this._$templateNameField.find("option:selected").val().split(":"),d=new a(this._editTemplateModalDialogId,this._popoverModalDialogEditTemplateLinkElementId,this._$editTemplateModalDialogPageContainer,this._$hiddenTemplateField,this._$templateDivField),d.mount(f,"openViaSelectBox",g))},d.prototype._loadTemplateContent=function(a){var b;if(this._newEmptyTemplateName=null!=(b=this._getTemplateNameDialog)?b.getNeEmptyTemplateName():void 0,null!=this._newEmptyTemplateName)return this._addEditTemplateConfirmEvent()},d.prototype._addEditTemplateConfirmEvent=function(){var a,b,c,d;return b="ct-ignition__button--confirm",d=document.querySelector(this.getIdFormat(this._editTemplateModalDialogPageContainerId)),c=d.contentDocument,a=$(c).find(this.getClassFormat(b)),a.unbind("click"),a.bind("click",this._confirmTemplateEdit)},d.prototype._confirmTemplateEdit=function(){if(null!=this._newEmptyTemplateName)return this._addNewSelectOpt(this._newEmptyTemplateName,this._$templateNameField),this._eraseNewTemplateName()},d.prototype._eraseNewTemplateName=function(){return this._newEmptyTemplateName=null},d.prototype._addNewSelectOpt=function(a,b){var c,d,e,f;if(d=$(this.getIdFormat(this._templateNameFieldId)+" option"),f=$.map(d,function(a){return a.value}),e="new_empty_template:"+a,-1===f.indexOf(e))return c=new Option(a,e),b.append(c),b.val(e)},d}(b),f=function(a){function b(a,b,c,d){this._htmlDoc=a,this._$editTemplatePageContainer=b,this._$templateDivField=c,this._$hiddenTemplateField=d,this._videoClass="video",this._verticalSpaceClassName="vertical-space",this._textContainerTags=["p","ul","ol","h1","h2","h3","h4","h5","h6"],this.convertVideoIframeToImgThumbnail()}return h(b,a),b.prototype.convertVideoIframeToImgThumbnail=function(){var a,b,c,d,e,f;return c=[],b=!1,f=new RegExp("youtube.com.*(v=|/embed/)(.{11})"),e=new RegExp("vimeo.com.*./(.*)"),a=function(a,b,c,d,e){return a.css("float",e),b.append(a),b.append(c),$(d).after(b),$(d).remove()},d=function(b){var c;return"vimeo"===this.videoType&&(c={src:b.thumbnail_url,width:b.thumbnail_width,height:b.thumbnail_height},this.$videoThumbnail.attr(c)),this.$videoCaption.text(b.title),a(this.$videoThumbnail,this.$clickableVideoThumbnail,this.$videoCaption,this.element,this.iframeCssFloatProperty)},$(this._htmlDoc).find("iframe").each(function(a){return function(g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u;return p=$(h).attr("src"),n=$(h).css("float"),q=$(h).attr("width"),o=$(h).attr("height"),i=$('<a href="" class="video"></a>'),i.attr("href",p),k=$('<img src="">'),k.attr({width:q,height:o}),j=$("<figcaption></figcaption>"),m={"text-align":"center","font-size":"12px"},j.css(m),p.match(f)?(b=!0,t=p.match(f).pop(),i.attr("id",t),i.addClass("youtube"),u="//img.youtube.com/vi/"+t+"/0.jpg",k.attr("src",u),r="http://www.youtube.com/watch?v="+t+"&",s="https://noembed.com/embed?url="+r,l={$videoThumbnail:k,$clickableVideoThumbnail:i,$videoCaption:j,element:h,iframeCssFloatProperty:n,videoType:"youtube"},c.push($.ajax(a.getAjaxData(l,s,d,"GET","jsonp")))):p.match(e)?(b=!0,t=p.match(e).pop(),i.attr("id",t),i.addClass("vimeo"),r="https://vimeo.com/"+t+"& width="+q+"&height="+o,s="https://vimeo.com/api/oembed.json?url="+r,l={$videoThumbnail:k,$clickableVideoThumbnail:i,$videoCaption:j,element:h,iframeCssFloatProperty:n,videoType:"vimeo"},c.push($.ajax(a.getAjaxData(l,s,d,"GET","jsonp")))):void 0}}(this)),$.when.apply(null,c).done(function(a){return function(){return a.convertCssToInlineStyle()}}(this))},b.prototype.getAjaxData=function(a,b,c,d,e){return null==d&&(d="GET"),null==e&&(e="json"),{type:d,url:b,jsonp:"callback",dataType:e,context:a,success:c}},b.prototype.convertCssToInlineStyle=function(){return this.inlineStyler($(this._htmlDoc)),this._fixContentWidth(),this._fixMargin(),this._replaceImgSrc(),this._convertTextCssPositionToTable(),this._eraseVerticalSpaceContent(),this._$templateDivField.html(this._$editTemplatePageContainer),this._$hiddenTemplateField.val(this._$editTemplatePageContainer.html())},b.prototype.inlineStyler=function(a){return a.inlineStyler()},b.prototype.getElementPosition=function(a,b,c){var d,e,f,g;return null==b&&(b=""),null==c&&(c=""),d=$("<table></table>"),d.attr({cellspacing:0,cellpadding:0,border:0,width:"100%"}),e=$("<tbody></tbody>"),g=$("<tr></tr>"),f=$("<td></td>"),f.css({border:"none",padding:0,margin:0}),f.attr({align:a,width:b,heigth:c}),d.append(e.append(g.append(f)))},b.prototype._replaceImgSrc=function(){var a;return a=this._$editTemplatePageContainer.find("img"),a.each(function(a){return function(b,c){var d,e,f,g,h;return d=$(c).closest(a.getClassFormat(a._videoClass)),e=d.length>0?d:$(c),0===d.length&&(h=$(c).attr("src"),g=new RegExp(window.origin),h.match(g)||(f=""+window.origin+$(c).attr("src"),$(c).attr("src",f))),a.convertImageCssPositionToTable(e)}}(this))},b.prototype.convertImageCssPositionToTable=function(a){var b,c,d,e,f,g,h;a=a.find("img").length>0?a.find("img"):a,f=parseInt(a.css("margin-left").split(".")[0].replace("px","")),g=parseInt(a.css("margin-right").split(".")[0].replace("px","")),e=a.css("float"),a.css("display",""),f===g&&"none"===e?c=this.getElementPosition("center","",""):f>g?(c=this.getElementPosition(e,a.attr("width"),a.attr("height")),b=this.convertImgFloatCssPositionToTable(a,this._$editTemplatePageContainer,e)):g>f?(c=this.getElementPosition(e,a.attr("width"),a.attr("height")),b=this.convertImgFloatCssPositionToTable(a,this._$editTemplatePageContainer,e)):"left"!==e&&"right"!==e||(c=this.getElementPosition(e,a.attr("width"),a.attr("height")),b=this.convertImgFloatCssPositionToTable(a,this._$editTemplatePageContainer,e)),h=this.getClassFormat(this._videoClass),d=a.closest(h),c.find("td").append(d.length>0?d.clone():a.clone()),"left"===e?c.find("tr").append(b):c.find("tr").prepend(b),d.length>0?d.after(c):a.after(c),d.length>0?d.remove():a.remove()},b.prototype.convertImgFloatCssPositionToTable=function(a,b,c){var d,e,f,g,h,i,j;return i=15,j="left"===c?"0 0 0 "+i+"px":"0 "+i+"px 0 0",e=$("<td></td>"),e.css({border:"none",padding:j,margin:"0"}),f=a.closest(this.getClassFormat(this._videoClass)),d=f.length>0?f.next().clone():a.next().clone(),h=parseFloat(b.find("#content_table").width()),g=h-parseFloat(a.attr("width"))-i,d.css("width",g),e.attr("width",g),e.append(d),f.length>0?f.next().remove():a.next().remove(),e},b.prototype._convertTextCssPositionToTable=function(){var a;return a=this._textContainerTags.join(", "),this._$editTemplatePageContainer.find(a).each(function(a){return function(b,c){var d,e;switch(e=$(c).attr("class")?$(c).attr("class").split(" "):[]){case e.indexOf("text-left")>-1:d=a.getElementPosition("left","","");break;case e.indexOf("text-right")>-1:d=a.getElementPosition("right","","");break;case e.indexOf("text-center")>-1:d=a.getElementPosition("center","","");break;default:d=a.getElementPosition("center","","")}return a.adjustListCssProperties($(c)),d.find("td").append($(c).clone()),$(c).after(d),$(c).remove()}}(this))},b.prototype.adjustListCssProperties=function(a){if(a.is("ul")||a.is("ol"))return a.css({margin:"10px",padding:"15px"})},b.prototype._fixMargin=function(){return $(this._htmlDoc).find("article").css("margin","")},b.prototype._getNumberValue=function(a,b){return null==b&&(b=-2),parseInt(a.slice(0,a.length-b))},b.prototype._getPaddingValue=function(a){var b,c;return null==a&&(a=!0),c=!0===a?"padding--left":"padding--top",b=$(this._htmlDoc).find(".article__content p").first().css(c),this._getNumberValue(b)},b.prototype._fixContentWidth=function(){var a,b;return b=this._getPaddingValue(),a=this._textContainerTags.join(", "),$(this._htmlDoc).find("article").find(a).each(function(a){return function(c,d){var e;return e=a._getNumberValue($(d).css("width")),$(d).css({width:e-2*b})}}(this))},b.prototype._eraseVerticalSpaceContent=function(){var a;return a=this.getClassFormat(this._verticalSpaceClassName),this._$editTemplatePageContainer.find(a).each(function(a,b){return $(b).find("center").remove()})},b}(b)}).call(this);